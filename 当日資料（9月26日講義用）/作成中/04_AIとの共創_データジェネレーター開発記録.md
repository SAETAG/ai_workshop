# AIとの共創：データジェネレーター開発記録
## リアルなCSVデータを生成するツールの作り方

---

## 📖 背景：なぜAIではなくプログラムで生成するのか

### ユーザーからの洞察

> データはAIが作ると嘘っぽくなるのでロジックをつくる。そのロジックは、プロンプトではなく、簡易的なPYTHON プログラムにしてランダム性などをセットして実行する。

この一言が、データ生成アプローチの転換点となりました。

### AIによるデータ生成の問題点

1. **パターンの単調さ**
   - AIは学習データのパターンを模倣するため、バリエーションが限定的
   - 「それっぽい」データは作れるが、統計的な分布が不自然

2. **論理的矛盾**
   - 例：高評価なのにネガティブなレビュー文
   - 例：冬なのにアイスクリームの売上が急増

3. **制御の難しさ**
   - 正確な比率や分布を指定しにくい
   - 再現性がない（同じプロンプトでも異なる結果）

### プログラムによる生成の利点

1. **統計的な正確性**
   - 正規分布、指数分布などを正確に適用
   - ビジネスの実態に即した分布を実現

2. **論理的整合性**
   - 相関関係を明確に定義可能
   - 矛盾のないデータを確実に生成

3. **再現性と拡張性**
   - シード値で完全に同じデータを再生成
   - 新しいロジックを簡単に追加可能

---

## 🛠️ 開発プロセス：AIとの対話

### Phase 1: 要件定義

**ユーザーの要求：**
- 汎用的な引数で、バリエーションに対応
- 項目も自由に入れられる
- ランダムネス、正規分布などの知識を駆使

**AIの提案：**
```
汎用的なデータジェネレーターを作成します：
1. JSON設定ファイルでデータ構造を定義
2. 様々な統計分布に対応
3. 列間の相関関係を定義可能
4. コマンドライン引数で柔軟に制御
```

### Phase 2: アーキテクチャ設計

```
tools/
├── csv_generator.py      # メインプログラム
├── configs/              # 設定ファイル
│   ├── review_config.json
│   ├── sales_config.json
│   └── tourist_config.json
└── README.md            # ドキュメント
```

### Phase 3: コア機能の実装

#### 1. 柔軟なデータ型システム

```python
# 様々なデータ型に対応
types = {
    'choice': '選択肢から選ぶ',
    'integer': '整数値',
    'float': '浮動小数点数',
    'date': '日付',
    'text': 'テンプレートベースのテキスト',
    'id': 'ID生成',
    'calculated': '他の列から計算'
}
```

#### 2. 統計分布の活用

```python
# 正規分布の例
if distribution == 'normal':
    mean = column_config.get('mean', (min_val + max_val) / 2)
    std = column_config.get('std', (max_val - min_val) / 6)
    value = np.random.normal(mean, std)
```

#### 3. 相関関係の定義

```json
{
  "correlations": [
    {
      "source": "customer_age_group",
      "target": "payment_method",
      "rules": {
        "20代": {
          "choices": {
            "現金": 0.20,
            "電子マネー": 0.40
          }
        }
      }
    }
  ]
}
```

---

## 💡 設計の工夫

### 1. 設定ファイルの外部化

**なぜ？**
- コードを変更せずにデータ構造を変更可能
- 非プログラマーでも設定を調整可能
- バージョン管理が容易

**実装例：**
```json
{
  "name": "顧客レビューデータ",
  "columns": [
    {
      "name": "rating",
      "type": "integer",
      "distribution": "normal",
      "mean": 3.8,
      "std": 1.2
    }
  ]
}
```

### 2. 重み付き選択

**なぜ？**
- 現実的な比率を再現
- 地域別の顧客分布など、実際のビジネスデータに近づける

**実装例：**
```python
if isinstance(choices, dict):
    items = list(choices.keys())
    weights = list(choices.values())
    return np.random.choice(items, p=weights)
```

### 3. テンプレートベースのテキスト生成

**なぜ？**
- バリエーションを保ちつつ、構造化されたテキストを生成
- レビューコメントなど、自然な文章を作成

**実装例：**
```json
{
  "templates": [
    "{quality}で{emotion}。{feature}が{evaluation}。"
  ],
  "replacements": {
    "quality": ["良い品質", "普通の品質"],
    "emotion": ["満足", "普通"]
  }
}
```

---

## 📊 実際の使用例

### 基本的な使い方

```bash
# 20行のレビューデータを生成
python csv_generator.py --config configs/review_config.json

# 100行の売上データを生成（シード値指定で再現可能）
python csv_generator.py --config configs/sales_config.json --rows 100 --seed 42
```

### 生成されるデータの品質

#### Before（AIで生成）
```csv
product_name,review_text,rating
嬉野茶,美味しいです。,5
嬉野茶,美味しいです。,5
嬉野茶,美味しいです。,5
```
→ パターンが単調、バリエーションがない

#### After（プログラムで生成）
```csv
product_name,review_text,rating
嬉野茶,香りが素晴らしく感動しました。朝食に最高です。,5
小城羊羹,甘さが普通で、普通でした。検討中です。,3
竹崎カニ,身が最高です、大満足です。また購入したいです。,5
```
→ 自然なバリエーション、評価と内容が一致

---

## 🎓 学んだこと

### 1. AIとプログラムの適材適所

| タスク | AI向き | プログラム向き |
|:-------|:-------|:---------------|
| アイデア出し | ✅ | ❌ |
| 構造設計 | ✅ | ❌ |
| データ生成 | ❌ | ✅ |
| ドキュメント作成 | ✅ | ❌ |

### 2. 統計的思考の重要性

- **正規分布**: 自然なばらつき（身長、テストの点数）
- **指数分布**: 待ち時間や間隔（購入間隔、滞在日数）
- **一様分布**: 完全なランダム（日付など）

### 3. 相関関係の設計

現実世界のデータは独立ではない：
- 年齢層 → 支払い方法
- 天気 → 売上
- グループサイズ → 消費額

これらの関係を明示的にモデル化することで、リアルなデータを生成。

---

## 🚀 今後の発展可能性

### 1. GUI化
- Webインターフェースで設定を作成
- リアルタイムプレビュー

### 2. 機械学習との連携
- 実データから統計パラメータを学習
- より現実的な相関関係の自動抽出

### 3. 大規模データ対応
- ストリーミング処理
- 分散生成

---

## 📝 まとめ：AIとの共創の真髄

このプロジェクトは、AIとプログラミングの**最適な組み合わせ**を示しています：

1. **AIの役割**
   - アーキテクチャの提案
   - コードの基本構造作成
   - ドキュメント作成

2. **人間の役割**
   - 要件定義と品質判断
   - ビジネスロジックの設計
   - 統計的な妥当性の確保

3. **プログラムの役割**
   - 正確な統計処理
   - 高速な大量データ生成
   - 再現可能な結果

### 最も重要な洞察

> **AIは「考える」ことが得意、プログラムは「実行する」ことが得意**

データ生成のような「正確性」と「制御性」が求められるタスクでは、AIでアイデアを練り、プログラムで実装するハイブリッドアプローチが最も効果的です。

---

## 🔗 関連資料

- [CSVデータジェネレーター README](./tools/README.md)
- [設定ファイルサンプル](./tools/configs/)
- [メインプログラム](./tools/csv_generator.py)

---

**この開発記録が、AIとの効果的な協働方法の参考になれば幸いです。**